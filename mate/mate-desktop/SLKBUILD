#Packager: George Vlahavas <vlahavas~at~gmail~dot~com>
# Modified for Slint by Didier Spaier <didier~at~slint~dot~fr> 

pkgname=mate-desktop
pkgver=1.24.2
_majorver=`echo $pkgver | sed "s/\(.*\)\.\(.*\)/\1/"`
pkgrel=1slint
source=("http://pub.mate-desktop.org/releases/${_majorver}/mate-desktop-${pkgver}.tar.xz" "mate-common.xml")
docs=("readme" "install" "copying" "changelog" "authors" "news" "todo")
options=('noautodotnew' 'nosrcpack')

# rev.2:make Slint gradient the default wallpaper  for the MATE
# desktop, as we will now have black panels by default. 

doinst() {
# compile schemas
if [ -x /usr/bin/glib-compile-schemas ]; then
        /usr/bin/glib-compile-schemas usr/share/glib-2.0/schemas > /dev/null 2>&1
fi
}

slackdesc=\
(
#|-----handy-ruler------------------------------------------------------|
"mate-desktop (The MATE Desktop environment)"
"The mate-desktop package includes common files needed for MATE"
"desktop apps (Pixmaps, .desktop files and internationalization files,"
"as well default settings for the MATE desktop)."
)

build() {
	cd $startdir/src/$pkgname-$pkgver
	./configure --prefix=/usr \
		--libdir=/usr/lib${LIBDIRSUFFIX} \
		--localstatedir=/var \
		--sysconfdir=/etc \
		--build=$arch-slackware-linux \
		--disable-schemas-compile \
		--disable-static \
		--disable-gtk-doc \
		--disable-gtk-doc-html \
		--disable-gtk-doc-pdf \
		--build=$arch-slackware-linux
	make -j $numjobs || return 1
	make install DESTDIR=$startdir/pkg
sed -i "s|Icon=gcolor2|Icon=/usr/share/icons/matefaenza/apps/scalable/gcolor2.svg|" $PKG/usr/share/applications/mate-color-select.desktop
mkdir -p $PKG/usr/share/applications
cp $startdir/mate-mimeapps.list $PKG/usr/share/applications
	# symlink all backgrounds from the slint-misc package in
	mkdir -p $startdir/pkg/usr/share/backgrounds/mate
	(
	cd $startdir/pkg/usr/share/backgrounds/mate/
	ln -sf /usr/share/wallpaper/common/ common
	)
	mkdir -p $PKG/usr/doc/$pkgname-$pkgver
	ln -s $PKG/usr/share/gtk-doc/html/mate-desktop $PKG/usr/doc/$pkgname-$pkgver/html
	mkdir $startdir/pkg/usr/share/mate-background-properties
	cp $startdir/src/mate-common.xml $startdir/pkg/usr/share/mate-background-properties/

} 
