# Maintainer: Albin Larsson <mail@albinlarsson.com>
# Contributor: Aleksandr Gornostal <ulauncher.app@gmail.com>

# To install, run `makepkg -is`

# Included in Slint by Didier Spaier didieratslintdotfr


pkgname=ulauncher
pkgver=5.15.15
pkgrel=1slint
slackdesc="$pkgname (Application launcher for Linux)"
#arch=('any')
url="https://ulauncher.io"
license=('GPL3')
depends=('gobject-introspection-runtime' 'libkeybinder3' 'gtk3' 'webkit2gtk' 'libnotify'
         'gdk-pixbuf2' 'wmctrl' 'python-dbus' 'python-levenshtein' 'python-pyinotify'
         'python-websocket-client' 'python-pyxdg' 'python-gobject' 'python-cairo')
makedepends=('git' 'python-setuptools' 'python-distutils-extra')
optdepends=('libappindicator-gtk3: tray icon')
install="ulauncher.install"
source=("https://github.com/Ulauncher/Ulauncher/releases/download/${pkgver}/ulauncher_${pkgver}.tar.gz"
"set_show_launcher_window_to_ctrl_leftsuper.diff")
sha256sums=('58e5837a487dadc5de88dfde8e2602e0110b849c1df7c1a49b20ce2cddba6b25')

build() {
  cd ulauncher
  patch -p1 --verbose < $SRC/set_show_launcher_window_to_ctrl_leftsuper.diff || exit 1
  env PATH=$(getconf PATH) python3 setup.py build
  export PYTHONHASHSEED=0
  env PATH=$(getconf PATH) python3 setup.py install --root="$PKG" --optimize=1 --skip-build
  rm -rf "$PKG"/usr/share/ulauncher/preferences/{no*,src,bow*,gul*,pack*}
  find $PKG -type d -name __pycache__ | xargs rm -rf
}
