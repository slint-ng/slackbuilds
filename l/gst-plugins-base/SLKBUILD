# Packager: Didier Spaier didieratslintdotfr

pkgname=gst-plugins-base
pkgver=1.20.4
pkgrel=1slint
source=("$pkgname-$pkgver.tar.xz")
url="https://gstreamer.freedesktop.org/"
makedepends=('meson' 'ninja')
docs=("AUTHORS*" "COPYING*" "ChangeLog" "NEWS*" "README*" "RELEASE*")

slackdesc=\
(
#|-----handy-ruler------------------------------------------------------|
"gst-plugins-base: gst-plugins-base (base set of GStreamer plugins)"
"gst-plugins-base:"
"gst-plugins-base: GStreamer Base Plug-ins is a well-groomed and well-maintained"
"gst-plugins-base: collection of GStreamer plug-ins and elements, spanning the"
"gst-plugins-base: range of possible types of elements one would want to write"
"gst-plugins-base: for GStreamer. It also contains helper libraries and base"
"gst-plugins-base: classes useful for writing elements. A wide range of video"
"gst-plugins-base: and audio decoders, encoders, and filters are included."
"gst-plugins-base:"
"gst-plugins-base:"
"gst-plugins-base:"
)

build() {
  cd "$SRC/$pkgname-$pkgver" || exit 1
  export CFLAGS="$SLKCFLAGS"
  export CXXFLAGS="$SLKCFLAGS"

  meson setup \
    --prefix=/usr \
    --libdir=lib${LIBDIRSUFFIX} \
    --libexecdir=/usr/libexec \
    --bindir=/usr/bin \
    --sbindir=/usr/sbin \
    --includedir=/usr/include \
    --datadir=/usr/share \
    --mandir=/usr/man \
    --sysconfdir=/etc \
    --localstatedir=/var \
    --buildtype=release \
    -Dexamples=disabled \
    meson-build

  if ! meson compile -C meson-build -j $numjobs; then
    cp -a gst-libs/gst/gl/xdg-shell-client-protocol.h .
    meson compile -C meson-build -j $numjobs
  fi
  DESTDIR="$PKG" meson install -C meson-build
}
