#Packager: George Vlahavas <vlahavas~at~gmail~dot~com>

pkgname=lightdm-gtk-greeter-settings
pkgver=1.2.2
pkgrel=1slint
source=("https://github.com/Xubuntu/lightdm-gtk-greeter-settings/releases/download/lightdm-gtk-greeter-settings-$pkgver/lightdm-gtk-greeter-settings-$pkgver.tar.gz"
	"username.patch")
docs=("readme" "install" "copying" "changelog" "authors" "news" "todo")
url=https://github.com/Xubuntu/lightdm-gtk-greeter-settings

slackdesc=\
(
#|-----handy-ruler------------------------------------------------------|
"lightdm-gtk-greeter-settings (LightDM GTK+ Greeter configuration tool)"
"LightDM GTK+ Greeter Settings is a GTK+ configuration tool for the"
"LightDM GTK+ Greeter."
)


build() {
	cd $startdir/src/$pkgname-$pkgver

	patch -p1 < $startdir/src/username.patch || exit 1

	python3 setup.py build || exit 1
	python3 setup.py install \
		--root=$startdir/pkg \
		--xfce-integration \
		--optimize=1 \
		|| exit 1

	# don't need this
	rm $startdir/pkg/usr/bin/lightdm-gtk-greeter-settings-pkexec
	# actually, this should be in /usr/sbin
	install -d -m 755 $startdir/pkg/usr/sbin
	mv $startdir/pkg/usr/bin/$pkgname $startdir/pkg/usr/sbin
	rmdir $startdir/pkg/usr/bin
	
	sed -i "s/^Exec=.*/Exec=gksu lightdm-gtk-greeter-settings/" \
		$startdir/pkg/usr/share/applications/lightdm-gtk-greeter-settings.desktop
} 
