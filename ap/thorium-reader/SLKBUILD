# Packager: Didier Spaier didieratslintdotfr


pkgname=thorium-reader
pkgver=2.3.0
pkgrel=1slint
export srcname=EDRLab.ThoriumReader_${pkgver}_amd64.deb
#arch=noarch
source=(https://raw.githubusercontent.com/edrlab/thorium-reader/develop/LICENSE
https://raw.githubusercontent.com/edrlab/thorium-reader/develop/README.md
https://raw.githubusercontent.com/edrlab/thorium-reader/develop/changelogs/CHANGELOG-v2.3.0.md
https://github.com/edrlab/thorium-reader/releases/download/v2.3.0/EDRLab.ThoriumReader_2.3.0_amd64.deb)
#sourcetemplate=http://people.salixos.org/yournick/$pkgname/$pkgver/
docs=("LICENSE")
#url=
#dotnew=()
#CFLAGS=
#CXXFLAGS=
options=('nosrcpack')

doinst() {
/usr/bin/update-desktop-database /usr/share/applications 1> /dev/null 2> /dev/null
/usr/bin/update-mime-database /usr/share/mime 1> /dev/null 2> /dev/null
/usr/bin/gtk-update-icon-cache -t -f /usr/share/icons/hicolor 1> /dev/null 2> /dev/null
}

slackdesc=\
(
#|-----handy-ruler------------------------------------------------------|
  "$pkgname (Easy to use EPUB reading application.)"
  "After importing e-books from a directory or OPDS feed, you'll be able"
  "to read on any screen size, customize layout settings, navigate via"
  "table of contents or page list, set bookmarks"
)

build() {
	ar x $srcname
	mkdir -p $pkgname-$pkgver
	tar xf data.tar.xz -C $pkgname-$pkgver
	cd $pkgname-$pkgver
	tar xf ../data.tar.xz
	cp -r opt $PKG/
	mkdir -p $PKG/usr/bin
	ln -sf $PKG/opt/Thorium/thorium $PKG/usr/bin/thorium
	mkdir -p $PKG/usr/share/applications \
	$PKG/usr/doc/$pkgname-$pkgver \
	$PKG/usr/share/icons \
	$PKG/usr/share/mime $PKG/usr/share/icons/
	cd usr/share/
	cp -r mime/* $PKG/usr/share/mime/
	cp applications/thorium.desktop $PKG/usr/share/applications
	cp -r icons/* $PKG/usr/share/icons
	cd $PKG/usr/doc/$pkgname-$pkgver
	pandoc -f gfm -t html5 -o README.html $SRC/README.md
	pandoc -f gfm -t html5 -o CHANGELOG-v2.3.0.html $SRC/CHANGELOG-v2.3.0.md
} 
